<!DOCTYPE html>
<html lang="zh-cn" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>playwright的python文档 | 蓝色空间号</title>
<meta name="keywords" content="">
<meta name="description" content="安装
引言
Playwright 是专门为满足端到端测试的需求而创建的。Playwright 支持包括 Chromium、WebKit 和 Firefox 在内的所有现代渲染引擎。在 Windows、Linux 和 macOS 上进行测试，无论是本地还是在 CI 上，无论是无头模式还是有头模式，都可以使用原生移动设备仿真。">
<meta name="author" content="新人类">
<link rel="canonical" href="http://localhost:1313/post/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/playwright%E7%9A%84python%E6%96%87%E6%A1%A3/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a29c24210eb31d9ce56f669c66a35c9c51b17376b7764e336a49af7dec914cf0.css" integrity="sha256-opwkIQ6zHZzlb2acZqNcnFGxc3a3dk4zakmvfeyRTPA=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh-cn" href="http://localhost:1313/post/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/playwright%E7%9A%84python%E6%96%87%E6%A1%A3/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="http://localhost:1313/post/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/playwright%E7%9A%84python%E6%96%87%E6%A1%A3/">
  <meta property="og:site_name" content="蓝色空间号">
  <meta property="og:title" content="playwright的python文档">
  <meta property="og:description" content="安装 引言 Playwright 是专门为满足端到端测试的需求而创建的。Playwright 支持包括 Chromium、WebKit 和 Firefox 在内的所有现代渲染引擎。在 Windows、Linux 和 macOS 上进行测试，无论是本地还是在 CI 上，无论是无头模式还是有头模式，都可以使用原生移动设备仿真。">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2025-11-20T15:58:14+00:00">
    <meta property="article:modified_time" content="2025-12-02T16:08:02+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="playwright的python文档">
<meta name="twitter:description" content="安装
引言
Playwright 是专门为满足端到端测试的需求而创建的。Playwright 支持包括 Chromium、WebKit 和 Firefox 在内的所有现代渲染引擎。在 Windows、Linux 和 macOS 上进行测试，无论是本地还是在 CI 上，无论是无头模式还是有头模式，都可以使用原生移动设备仿真。">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "playwright的python文档",
      "item": "http://localhost:1313/post/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/playwright%E7%9A%84python%E6%96%87%E6%A1%A3/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "playwright的python文档",
  "name": "playwright的python文档",
  "description": "安装 引言 Playwright 是专门为满足端到端测试的需求而创建的。Playwright 支持包括 Chromium、WebKit 和 Firefox 在内的所有现代渲染引擎。在 Windows、Linux 和 macOS 上进行测试，无论是本地还是在 CI 上，无论是无头模式还是有头模式，都可以使用原生移动设备仿真。\n",
  "keywords": [
    
  ],
  "articleBody": "安装 引言 Playwright 是专门为满足端到端测试的需求而创建的。Playwright 支持包括 Chromium、WebKit 和 Firefox 在内的所有现代渲染引擎。在 Windows、Linux 和 macOS 上进行测试，无论是本地还是在 CI 上，无论是无头模式还是有头模式，都可以使用原生移动设备仿真。\nPlaywright 库可以用作通用的浏览器自动化工具，为同步和异步 Python 提供了一套强大的 API 来自动化 Web 应用程序。\n本介绍描述了 Playwright Pytest 插件，这是编写端到端测试的推荐方式。\n你将学到\n如何安装 Playwright Pytest 如何运行示例测试 安装 Playwright Pytest Playwright 建议使用官方的 Playwright Pytest 插件来编写端到端测试。它提供了上下文隔离，并开箱即用地在多个浏览器配置上运行。\n首先，通过安装 Playwright 并运行示例测试来开始，亲眼看看它是如何工作的。\nPyPI Anaconda 安装所需的浏览器：\n添加示例测试 在当前工作目录或遵循 test_ 前缀约定的子目录中创建一个文件，例如 test_example.py，并在其中包含以下代码。确保你的测试名称也遵循 test_ 前缀约定。\ntest_example.py\nimport re from playwright.sync_api import Page, expect def test_has_title(page: Page): page.goto(\"https://playwright.dev/\") # 期望标题“包含”一个子字符串。 expect(page).to_have_title(re.compile(\"Playwright\")) def test_get_started_link(page: Page): page.goto(\"https://playwright.dev/\") # 点击“开始”链接。 page.get_by_role(\"link\", name=\"Get started\").click() # 期望页面有一个名为“安装”的标题。 expect(page.get_by_role(\"heading\", name=\"Installation\")).to_be_visible() 运行示例测试 默认情况下，测试将在 Chromium 上运行。这可以通过 CLI 选项进行配置。测试以无头模式运行，这意味着在运行测试时不会打开浏览器 UI。测试结果和测试日志将在终端中显示。\n更新 Playwright 要将 Playwright 更新到最新版本，请运行以下命令：\npip install pytest-playwright playwright -U 系统要求 Python 3.8 或更高版本。 Windows 10+、Windows Server 2016+ 或 Windows Subsystem for Linux (WSL)。 MacOS 12 Monterey、MacOS 13 Ventura 或 MacOS 14 Sonoma。 Debian 11、Debian 12、Ubuntu 20.04 或 Ubuntu 22.04。 接下来是什么 使用 Web 优先断言、页面夹具和定位器编写测试 运行单个测试、多个测试、有头模式 使用 Codegen 生成测试 查看测试的跟踪 编写测试用例 引言 Playwright 测试很简单，它们\n执行操作 ， 断言状态与预期相符。 在执行操作之前没有必要等待任何东西：Playwright 在执行每个操作之前会自动等待一系列可操作性检查通过。\n也没有必要在执行检查时处理竞态条件 - Playwright 断言的设计方式是它们描述了最终需要满足的预期。\n就是这样！这些设计选择允许 Playwright 用户完全忘记他们测试中的不稳定超时和竞态检查。\n你将学到\n如何编写第一个测试 如何执行操作 如何使用断言 测试如何独立运行 如何使用测试钩子 第一个测试 查看以下示例，了解如何编写测试。注意文件名遵循 test_ 前缀约定，以及每个测试名称。\ntest_example.py\nimport re from playwright.sync_api import Page, expect def test_has_title(page: Page): page.goto(\"https://playwright.dev/\") # 期望标题“包含”一个子字符串。 expect(page).to_have_title(re.compile(\"Playwright\")) def test_get_started_link(page: Page): page.goto(\"https://playwright.dev/\") # 点击“开始”链接。 page.get_by_role(\"link\", name=\"Get started\").click() # 期望页面有一个名为“安装”的标题。 expect(page.get_by_role(\"heading\", name=\"Installation\")).to_be_visible() 操作 导航 大多数测试将从导航到 URL 的页面开始。之后，测试将能够与页面元素进行交互。\npage.goto(\"https://playwright.dev/\") Playwright 会等待页面达到加载状态，然后再继续。了解更多关于 page.goto() 选项的信息。\n交互 执行操作从定位元素开始。Playwright 使用 Locators API 进行此操作。定位器代表了在任何时刻在页面上查找元素（或元素组）的方式，了解更多关于可用的不同类型定位器的信息。Playwright 会在执行操作之前等待元素可操作，因此没有必要等待其变为可用。\n# 创建一个定位器。 get_started = page.get_by_role(\"link\", name=\"Get started\") # 点击它。 get_started.click() 在大多数情况下，它会写成一行：\npage.get_by_role(\"link\", name=\"Get started\").click() 基本操作 这是最受欢迎的 Playwright 操作列表。请注意，还有更多操作，请确保查看定位器 API 部分以了解更多信息。\n操作 描述 locator.check() 检查输入复选框 locator.click() 点击元素 locator.uncheck() 取消检查输入复选框 locator.hover() 鼠标悬停在元素上 locator.fill() 填写表单字段，输入文本 locator.focus() 使元素获得焦点 locator.press() 按下单个键 locator.set_input_files() 选择上传的文件 locator.select_option() 在下拉菜单中选择选项 断言 Playwright 包括断言，这些断言会等待直到满足预期条件。使用这些断言可以使测试不脆弱且具有弹性。例如，这段代码会等待页面获得包含“Playwright”的标题：\nimport re from playwright.sync_api import expect expect(page).to_have_title(re.compile(\"Playwright\")) 这是最受欢迎的异步断言列表。请注意，还有更多断言需要熟悉：\n断言 描述 expect(locator).to_be_checked() 复选框被选中 expect(locator).to_be_enabled() 控件被启用 expect(locator).to_be_visible() 元素可见 expect(locator).to_contain_text() 元素包含文本 expect(locator).to_have_attribute() 元素具有属性 expect(locator).to_have_count() 元素列表具有给定长度 expect(locator).to_have_text() 元素匹配文本`` expect(locator).to_have_value() 输入元素具有值`` expect(page).to_have_title() 页面具有标题`` expect(page).to_have_url() 页面具有 URL 测试隔离 Playwright Pytest 插件基于测试夹具的概念，例如内置的页面夹具，它被传递到你的测试中。由于浏览器上下文，页面在测试之间是隔离的，这相当于一个全新的浏览器配置文件，每个测试都获得一个新鲜环境，即使多个测试在单个浏览器中运行。\ntest_example.py\nfrom playwright.sync_api import Page def test_example_test(page: Page): pass # “page”属于一个独立的 BrowserContext，为这个特定测试创建。 def test_another_test(page: Page): pass # 这个第二个测试中的“page”与第一个测试完全隔离。 使用夹具 你可以使用各种夹具在测试之前或之后执行代码并共享对象。一个 function 作用域的夹具，例如带有 autouse 的，表现得像 beforeEach/afterEach。一个 module 作用域的夹具带有 autouse 表现得像 beforeAll/afterAll，它在所有测试之前和之后运行。\ntest_example.py\nimport pytest from playwright.sync_api import Page, expect @pytest.fixture(scope=\"function\", autouse=True) def before_each_after_each(page: Page): print(\"before the test runs\") # 在每个测试之前转到起始 URL。 page.goto(\"https://playwright.dev/\") yield print(\"after the test runs\") def test_main_navigation(page: Page): # 断言使用 expect API。 expect(page).to_have_url(\"https://playwright.dev/\") 接下来是什么 运行单个测试，多个测试，有头模式 使用 Codegen 生成测试 查看测试的跟踪 在 CI 上运行测试与 GitHub Actions 生成测试 引言 Playwright 提供了开箱即用的测试生成能力，是快速开始测试的绝佳方式。它将打开两个窗口，一个浏览器窗口，您可以在其中与您想要测试的网站进行交互；另一个是 Playwright 检查器窗口，您可以在其中录制测试、复制测试、清除测试以及更改测试的语言。\n您将学到\n如何录制测试 如何生成定位器 运行 Codegen 使用 codegen 命令运行测试生成器，然后是您想要为其生成测试的网站的 URL。URL 是可选的，您也可以在不指定 URL 的情况下运行命令，然后在浏览器窗口中直接添加 URL。\nplaywright codegen demo.playwright.dev/todomvc 录制测试 运行 codegen 并在浏览器中执行操作。Playwright 将为用户交互生成代码。Codegen 将查看渲染后的页面并找出推荐的定位器，优先考虑角色、文本和测试 ID 定位器。如果生成器识别出多个元素与定位器匹配，它将改进定位器，使其更具弹性并唯一地识别目标元素，从而消除和减少由于定位器导致的测试失败和不稳定。\n使用测试生成器，您可以录制：\n通过简单地与页面交互，执行点击或填充等操作 通过点击工具栏上的一个图标，然后点击页面上的元素进行断言。您可以选择： 'assert visibility' 断言元素可见 'assert text' 断言元素包含特定文本 'assert value' 断言元素具有特定值 当您完成与页面的交互后，按下 'record' 按钮停止录制，并使用 'copy' 按钮将生成的代码复制到您的编辑器中。\n使用 'clear' 按钮清除代码以开始重新录制。完成后，关闭 Playwright 检查器窗口或停止终端命令。\n要了解更多关于生成测试的信息，请查看我们关于 Codegen 的详细指南。\n生成定位器 您可以使用测试生成器生成定位器。\n按下 'Record' 按钮停止录制，‘Pick Locator’` 按钮将会出现。 点击 'Pick Locator' 按钮，然后将鼠标悬停在浏览器窗口的元素上，以查看定位器在每个元素下方突出显示。 要选择一个定位器，单击您想要定位的元素，该定位器的代码将出现在 Pick Locator 按钮旁边的定位器游乐场中。 然后您可以在定位器游乐场中编辑定位器以微调它，并看到匹配的元素在浏览器窗口中突出显示。 使用复制按钮复制定位器并将其粘贴到您的代码中。 仿真 您还可以使用仿真生成测试，以便为特定的视口、设备、颜色方案生成测试，以及模拟地理位置、语言或时区。测试生成器还可以在保持认证状态的同时生成测试。查看测试生成器指南以了解更多信息。\n接下来做什么 查看您的测试跟踪 运行和调试 引言 您可以运行单个测试、一组测试或所有测试。使用 --browser 标志，可以在一个浏览器或多个浏览器上运行测试。默认情况下，测试以无头模式运行，这意味着在运行测试时不会打开浏览器窗口，结果将在终端中显示。如果您愿意，可以通过使用 --headed CLI 参数以有头模式运行您的测试。\n您将学到\n如何从命令行运行测试 如何调试测试 运行测试 命令行 要运行您的测试，请使用 pytest 命令。这将默认在 Chromium 浏览器上运行您的测试。默认情况下，测试以无头模式运行，这意味着在运行测试时不会打开浏览器窗口，结果将在终端中显示。\n在有头模式下运行测试 要以有头模式运行您的测试，请使用 --headed 标志。这将在运行测试时打开浏览器窗口，并在完成后关闭浏览器窗口。\n在不同的浏览器上运行测试 要指定您想要运行测试的浏览器，请使用 --browser 标志，后跟浏览器的名称。\n要指定要在多个浏览器上运行测试，请多次使用 --browser 标志，后跟每个浏览器的名称。\npytest --browser webkit --browser firefox 运行特定测试 要运行单个测试文件，请传入您想要运行的测试文件的名称。\n要运行一组测试文件，请传入您想要运行的测试文件的名称。\npytest tests/test_todo_page.py tests/test_landing_page.py 要运行特定测试，请传入您想要运行的测试的函数名称。\npytest -k test_add_a_todo_item 并行运行测试 要并行运行您的测试，请使用 --numprocesses 标志，后跟您想要运行测试的进程数量。我们建议使用逻辑 CPU 核心数的一半。\n（这假设已安装了 pytest-xdist。有关更多信息，请参见此处。）\n有关更多信息，请参见 Playwright Pytest 使用情况或 Pytest 文档以了解一般 CLI 使用情况。\n调试测试 由于 Playwright 在 Python 中运行，您可以使用您选择的调试器进行调试，例如使用 Visual Studio Code 中的 Python 扩展。Playwright 带有 Playwright 检查器，允许您逐步执行 Playwright API 调用，查看它们的调试日志并探索定位器。\n要调试所有测试，请运行以下命令。\nBash PowerShell Batch 要调试一个测试文件，请在命令后运行您想要调试的测试文件的名称。\nBash PowerShell Batch PWDEBUG=1 pytest -s test_example.py 要调试特定测试，请添加 -k 后跟您想要调试的测试的名称。\nBash PowerShell Batch PWDEBUG=1 pytest -s -k test_get_started_link 此命令将打开浏览器窗口以及 Playwright 检查器。您可以使用检查器顶部的步过按钮逐步执行您的测试。或者按下播放按钮从开始到结束运行您的测试。一旦测试完成，浏览器窗口将关闭。\n在调试时，您可以使用选择定位器按钮来选择页面上的元素，并查看 Playwright 用于查找该元素的定位器。您还可以编辑定位器并实时在浏览器窗口中看到它被高亮显示。使用复制定位器按钮将定位器复制到剪贴板，然后将其粘贴到您的测试中。\n查看我们的调试指南，以了解更多关于 Playwright 检查器以及使用浏览器开发工具进行调试的信息。\n接下来做什么 使用 Codegen 生成测试 查看您的测试跟踪 在 CI 上使用 GitHub Actions 运行您的测试 跟踪查看器 介绍 Playwright Trace Viewer 是一个图形用户界面（GUI）工具，允许您探索录制的 Playwright 测试跟踪，这意味着您可以前后浏览测试的每个动作，并直观地看到每个动作期间发生了什么。\n您将学到\n如何录制跟踪 如何打开 HTML 报告 如何打开跟踪查看器 录制跟踪 可以通过使用 --tracing 标志运行测试来录制跟踪。\n跟踪的选项有：\non: 为每个测试录制跟踪 off: 不录制跟踪。（默认） retain-on-failure: 为每个测试录制跟踪，但删除成功测试运行的所有跟踪。 这将录制跟踪并将其放入 test-results 目录中名为 trace.zip 的文件中。\n如果您没有使用 Pytest，请点击这里了解如何录制跟踪。\n同步 异步 browser = chromium.launch() context = browser.new_context() # 在创建/导航页面之前开始跟踪。 context.tracing.start(screenshots=True, snapshots=True, sources=True) page = context.new_page() page.goto(\"https://playwright.dev\") # 停止跟踪并将其导出到 zip 归档中。 context.tracing.stop(path=\"trace.zip\") 打开跟踪 您可以使用 Playwright CLI 或在 trace.playwright.dev 上的浏览器中打开保存的跟踪。确保添加您的 trace.zip 文件所在的完整路径。这应该包括 test-results 目录，然后是测试名称，最后是 trace.zip。\nplaywright show-trace trace.zip 查看跟踪 通过点击每个动作或使用时间线悬停来查看测试的跟踪，并查看动作前后页面的状态。在测试的每个步骤期间检查日志、源代码和网络。跟踪查看器创建了一个 DOM 快照，因此您可以完全与之交互，打开开发工具等。\n要了解更多信息，请查看我们关于跟踪查看器的详细指南。\n接下来是什么 在 GitHub Actions 上运行 CI 测试 了解更多关于跟踪查看器的信息 Pytest 插件来编写端到端测试 引言 Playwright 提供了一个 Pytest 插件来编写端到端测试。要开始使用它，请参考入门指南。\n使用方法 要运行测试，请使用 Pytest 命令行界面。\npytest --browser webkit --headed 如果你想自动添加命令行参数而不需要明确指定它们，你可以使用 pytest.ini 文件：\n# pytest.ini 文件的内容 [pytest] # 使用 UI 运行 firefox addopts = --headed --browser firefox 命令行参数 请注意，命令行参数仅应用于默认的 browser、context 和 page 固定装置。如果你使用 API 调用如 browser.new_context() 创建浏览器、上下文或页面，命令行参数将不会应用。\n--headed：以有头模式运行测试（默认：无头）。 --browser：在不同的浏览器中运行测试 chromium、firefox 或 webkit。可以多次指定（默认：chromium）。 --browser-channel：要使用的浏览器渠道。 --slowmo：通过指定的毫秒数减慢 Playwright 操作。这样你可以看清楚发生了什么（默认：0）。 --device：要模拟的设备。 --output：由测试产生的工件目录（默认：test-results）。 --tracing：是否为每个测试记录跟踪。on、off 或 retain-on-failure（默认：off）。 --video：是否为每个测试录制视频。on、off 或 retain-on-failure（默认：off）。 --screenshot：是否在每个测试后自动捕获屏幕截图。on、off 或 only-on-failure（默认：off）。 --full-page-screenshot：在失败时是否拍摄整个页面的屏幕截图。默认情况下，只捕获视口。需要启用 --screenshot（默认：off）。 固定装置 这个插件为 pytest 配置了 Playwright 特定的固定装置。要使用这些固定装置，将固定装置名称作为参数传递给测试函数。\ndef test_my_app_is_working(fixture_name): pass # 使用 fixture_name 进行测试 # ... 函数范围 ：当在测试函数中请求时，这些固定装置被创建，并在测试结束时销毁。\ncontext：测试的新浏览器上下文。 page：测试的新浏览器页面。 new_context：允许为测试创建不同的浏览器上下文。适用于多用户场景。接受与 browser.new_context() 相同的参数。 会话范围 ：当在测试函数中请求时，这些固定装置被创建，并在所有测试结束时销毁。\nplaywright：Playwright 实例。 browser_type：当前浏览器的 BrowserType 实例。 browser：由 Playwright 启动的浏览器实例。 browser_name：浏览器名称字符串。 browser_channel：浏览器渠道字符串。 is_chromium、is_webkit、is_firefox：相应浏览器类型的布尔值。 自定义固定装置选项 ：对于 browser 和 context 固定装置，使用以下固定装置定义自定义启动选项。\nbrowser_type_launch_args：覆盖 browser_type.launch() 的启动参数。它应该返回一个字典。 browser_context_args：覆盖 browser.new_context() 的选项。它应该返回一个字典。 也可以通过使用 browser_context_args 标记来覆盖单个测试的上下文选项（browser.new_context()）：\nimport pytest @pytest.mark.browser_context_args(timezone_id=\"Europe/Berlin\", locale=\"en-GB\") def test_browser_context_args(page): assert page.evaluate(\"window.navigator.userAgent\") == \"Europe/Berlin\" assert page.evaluate(\"window.navigator.languages\") == [\"de-DE\"] 并行性：同时运行多个测试 如果你的测试在拥有大量 CPU 的机器上运行，你可以通过使用 pytest-xdist 同时运行多个测试来加快测试套件的整体执行时间：\n# 安装依赖 pip install pytest-xdist # 使用 --numprocesses 标志 pytest --numprocesses auto 根据硬件和测试的性质，你可以将 numprocesses 设置为从 2 到机器上的 CPU 数量。如果设置得太高，你可能会注意到意外的行为。\n有关 pytest 选项的一般信息，请参见运行测试。\n示例 为自动补全配置 Mypy 类型 test_my_application.py\nfrom playwright.sync_api import Page def test_visit_admin_dashboard(page: Page): page.goto(\"/admin\") # ... 配置慢动作 使用 --slowmo 参数运行测试。\n将 Playwright 操作减慢 100 毫秒。\n按浏览器跳过测试 test_my_application.py\nimport pytest @pytest.mark.skip_browser(\"firefox\") def test_visit_example(page): page.goto(\"https://example.com\") # ... 在特定浏览器上运行 conftest.py\nimport pytest @pytest.mark.only_browser(\"chromium\") def test_visit_example(page): page.goto(\"https://example.com\") # ... 使用自定义浏览器渠道，如 Google Chrome 或 Microsoft Edge pytest --browser-channel chrome test_my_application.py\ndef test_example(page): page.goto(\"https://example.com\") 配置基础 URL 使用 base-url 参数启动 Pytest。pytest-base-url 插件用于此目的，它允许你从配置、命令行参数或固定装置中设置基础 URL。\npytest --base-url http://localhost:8080 test_my_application.py\ndef test_visit_example(page): page.goto(\"/admin\") # -\u003e 将导致 http://localhost:8080/admin 忽略 HTTPS 错误 conftest.py\nimport pytest @pytest.fixture(scope=\"session\") def browser_context_args(browser_context_args): return { **browser_context_args, \"ignore_https_errors\": True } 使用自定义视口大小 conftest.py\nimport pytest @pytest.fixture(scope=\"session\") def browser_context_args(browser_context_args): return { **browser_context_args, \"viewport\": { \"width\": 1920, \"height\": 1080, } } 设备模拟 conftest.py\nimport pytest @pytest.fixture(scope=\"session\") def browser_context_args(browser_context_args, playwright): iphone_11 = playwright.devices['iPhone 11 Pro'] return { **browser_context_args, **iphone_11, } 或通过命令行 --device=\"iPhone 11 Pro\"。\n与 unittest.TestCase 一起使用 查看以下示例，了解如何将其与 unittest.TestCase 一起使用。这有一个限制，即只能指定单个浏览器，并且在指定多个浏览器时不会生成多个浏览器的矩阵。\nimport pytest import unittest from playwright.sync_api import Page class MyTest(unittest.TestCase): @pytest.fixture(autouse=True) def setup(self, page: Page): self.page = page def test_foobar(self): self.page.goto(\"https://microsoft.com\") self.page.locator(\"#foobar\").click() assert self.page.evaluate(\"1 + 1\") == 2 调试 与 pdb 一起使用 在你的测试代码中使用 breakpoint() 语句来暂停执行并获得 pdb REPL。\ndef test_bing_is_working(page): page.goto(\"https://bing.com\") breakpoint() # ... 部署到 CI 请参阅 CI 提供商的指南，了解如何将你的测试部署到 CI/CD。\n",
  "wordCount" : "6219",
  "inLanguage": "zh-cn",
  "datePublished": "2025-11-20T15:58:14Z",
  "dateModified": "2025-12-02T16:08:02Z",
  "author":{
    "@type": "Person",
    "name": "新人类"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/post/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/playwright%E7%9A%84python%E6%96%87%E6%A1%A3/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "蓝色空间号",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="蓝色空间号 (Alt + H)">蓝色空间号</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="首页">
                    <span>首页</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/post/" title="文章">
                    <span>文章</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="关于">
                    <span>关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/post/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      playwright的python文档
    </h1>
    <div class="post-meta"><span title='2025-11-20 15:58:14 +0000 +0000'>2025-11-20</span>&nbsp;·&nbsp;<span>13 min</span>&nbsp;·&nbsp;<span>6219 words</span>&nbsp;·&nbsp;<span>新人类</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#引言">引言</a></li>
    <li><a href="#安装-playwright-pytest">安装 Playwright Pytest</a></li>
    <li><a href="#添加示例测试">添加示例测试</a></li>
    <li><a href="#运行示例测试">运行示例测试</a></li>
    <li><a href="#更新-playwright">更新 Playwright</a></li>
    <li><a href="#系统要求">系统要求</a></li>
    <li><a href="#接下来是什么">接下来是什么</a></li>
  </ul>

  <ul>
    <li><a href="#引言-1">引言</a></li>
    <li><a href="#第一个测试">第一个测试</a></li>
    <li><a href="#操作">操作</a>
      <ul>
        <li><a href="#导航">导航</a></li>
        <li><a href="#交互">交互</a></li>
        <li><a href="#基本操作">基本操作</a></li>
      </ul>
    </li>
    <li><a href="#断言">断言</a>
      <ul>
        <li><a href="#测试隔离">测试隔离</a></li>
        <li><a href="#使用夹具">使用夹具</a></li>
      </ul>
    </li>
    <li><a href="#接下来是什么-1">接下来是什么</a></li>
  </ul>

  <ul>
    <li><a href="#引言-2">引言</a></li>
    <li><a href="#运行-codegen">运行 Codegen</a>
      <ul>
        <li><a href="#录制测试">录制测试</a></li>
        <li><a href="#生成定位器">生成定位器</a></li>
        <li><a href="#仿真">仿真</a></li>
      </ul>
    </li>
    <li><a href="#接下来做什么">接下来做什么</a></li>
  </ul>

  <ul>
    <li><a href="#引言-3">引言</a></li>
    <li><a href="#运行测试">运行测试</a>
      <ul>
        <li><a href="#命令行">命令行</a></li>
        <li><a href="#在有头模式下运行测试">在有头模式下运行测试</a></li>
        <li><a href="#在不同的浏览器上运行测试">在不同的浏览器上运行测试</a></li>
        <li><a href="#运行特定测试">运行特定测试</a></li>
        <li><a href="#并行运行测试">并行运行测试</a></li>
      </ul>
    </li>
    <li><a href="#调试测试">调试测试</a></li>
    <li><a href="#接下来做什么-1">接下来做什么</a></li>
  </ul>

  <ul>
    <li><a href="#介绍">介绍</a></li>
    <li><a href="#录制跟踪">录制跟踪</a></li>
    <li><a href="#打开跟踪">打开跟踪</a></li>
    <li><a href="#查看跟踪">查看跟踪</a></li>
    <li><a href="#接下来是什么-2">接下来是什么</a></li>
  </ul>

  <ul>
    <li><a href="#引言-4">引言</a></li>
    <li><a href="#使用方法">使用方法</a></li>
    <li><a href="#命令行参数">命令行参数</a></li>
    <li><a href="#固定装置">固定装置</a></li>
    <li><a href="#并行性同时运行多个测试">并行性：同时运行多个测试</a></li>
    <li><a href="#示例">示例</a>
      <ul>
        <li><a href="#为自动补全配置-mypy-类型">为自动补全配置 Mypy 类型</a></li>
        <li><a href="#配置慢动作">配置慢动作</a></li>
        <li><a href="#按浏览器跳过测试">按浏览器跳过测试</a></li>
        <li><a href="#在特定浏览器上运行">在特定浏览器上运行</a></li>
        <li><a href="#使用自定义浏览器渠道如-google-chrome-或-microsoft-edge">使用自定义浏览器渠道，如 Google Chrome 或 Microsoft Edge</a></li>
        <li><a href="#配置基础-url">配置基础 URL</a></li>
        <li><a href="#忽略-https-错误">忽略 HTTPS 错误</a></li>
        <li><a href="#使用自定义视口大小">使用自定义视口大小</a></li>
        <li><a href="#设备模拟">设备模拟</a></li>
        <li><a href="#与-unittesttestcase-一起使用">与 <code>unittest.TestCase</code> 一起使用</a></li>
      </ul>
    </li>
    <li><a href="#调试">调试</a>
      <ul>
        <li><a href="#与-pdb-一起使用">与 pdb 一起使用</a></li>
      </ul>
    </li>
    <li><a href="#部署到-ci">部署到 CI</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="安装">安装<a hidden class="anchor" aria-hidden="true" href="#安装">#</a></h1>
<h2 id="引言">引言<a hidden class="anchor" aria-hidden="true" href="#引言">#</a></h2>
<p>Playwright 是专门为满足端到端测试的需求而创建的。Playwright 支持包括 Chromium、WebKit 和 Firefox 在内的所有现代渲染引擎。在 Windows、Linux 和 macOS 上进行测试，无论是本地还是在 CI 上，无论是无头模式还是有头模式，都可以使用原生移动设备仿真。</p>
<p>Playwright 库可以用作通用的浏览器自动化工具，为同步和异步 Python 提供了一套强大的 API 来自动化 Web 应用程序。</p>
<p>本介绍描述了 Playwright Pytest 插件，这是编写端到端测试的推荐方式。</p>
<p><strong>你将学到</strong></p>
<ul>
<li>如何安装 Playwright Pytest</li>
<li>如何运行示例测试</li>
</ul>
<h2 id="安装-playwright-pytest">安装 Playwright Pytest<a hidden class="anchor" aria-hidden="true" href="#安装-playwright-pytest">#</a></h2>
<p>Playwright 建议使用官方的 Playwright Pytest 插件来编写端到端测试。它提供了上下文隔离，并开箱即用地在多个浏览器配置上运行。</p>
<p>首先，通过安装 Playwright 并运行示例测试来开始，亲眼看看它是如何工作的。</p>
<ul>
<li>PyPI</li>
<li>Anaconda</li>
</ul>
<p>安装所需的浏览器：</p>
<h2 id="添加示例测试">添加示例测试<a hidden class="anchor" aria-hidden="true" href="#添加示例测试">#</a></h2>
<p>在当前工作目录或遵循 <code>test_</code> 前缀约定的子目录中创建一个文件，例如 <code>test_example.py</code>，并在其中包含以下代码。确保你的测试名称也遵循 <code>test_</code> 前缀约定。</p>
<p>test_example.py</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">playwright.sync_api</span> <span class="kn">import</span> <span class="n">Page</span><span class="p">,</span> <span class="n">expect</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_has_title</span><span class="p">(</span><span class="n">page</span><span class="p">:</span> <span class="n">Page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&#34;https://playwright.dev/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 期望标题“包含”一个子字符串。</span>
</span></span><span class="line"><span class="cl">    <span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">to_have_title</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&#34;Playwright&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_get_started_link</span><span class="p">(</span><span class="n">page</span><span class="p">:</span> <span class="n">Page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&#34;https://playwright.dev/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 点击“开始”链接。</span>
</span></span><span class="line"><span class="cl">    <span class="n">page</span><span class="o">.</span><span class="n">get_by_role</span><span class="p">(</span><span class="s2">&#34;link&#34;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Get started&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 期望页面有一个名为“安装”的标题。</span>
</span></span><span class="line"><span class="cl">    <span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">get_by_role</span><span class="p">(</span><span class="s2">&#34;heading&#34;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Installation&#34;</span><span class="p">))</span><span class="o">.</span><span class="n">to_be_visible</span><span class="p">()</span>
</span></span></code></pre></div><h2 id="运行示例测试">运行示例测试<a hidden class="anchor" aria-hidden="true" href="#运行示例测试">#</a></h2>
<p>默认情况下，测试将在 Chromium 上运行。这可以通过 CLI 选项进行配置。测试以无头模式运行，这意味着在运行测试时不会打开浏览器 UI。测试结果和测试日志将在终端中显示。</p>
<h2 id="更新-playwright">更新 Playwright<a hidden class="anchor" aria-hidden="true" href="#更新-playwright">#</a></h2>
<p>要将 Playwright 更新到最新版本，请运行以下命令：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">pip install pytest-playwright playwright -U
</span></span></code></pre></div><h2 id="系统要求">系统要求<a hidden class="anchor" aria-hidden="true" href="#系统要求">#</a></h2>
<ul>
<li>Python 3.8 或更高版本。</li>
<li>Windows 10+、Windows Server 2016+ 或 Windows Subsystem for Linux (WSL)。</li>
<li>MacOS 12 Monterey、MacOS 13 Ventura 或 MacOS 14 Sonoma。</li>
<li>Debian 11、Debian 12、Ubuntu 20.04 或 Ubuntu 22.04。</li>
</ul>
<h2 id="接下来是什么">接下来是什么<a hidden class="anchor" aria-hidden="true" href="#接下来是什么">#</a></h2>
<ul>
<li>使用 Web 优先断言、页面夹具和定位器编写测试</li>
<li>运行单个测试、多个测试、有头模式</li>
<li>使用 Codegen 生成测试</li>
<li>查看测试的跟踪</li>
</ul>
<h1 id="编写测试用例">编写测试用例<a hidden class="anchor" aria-hidden="true" href="#编写测试用例">#</a></h1>
<h2 id="引言-1">引言<a hidden class="anchor" aria-hidden="true" href="#引言-1">#</a></h2>
<p>Playwright 测试很简单，它们</p>
<ul>
<li><strong>执行操作</strong> ，</li>
<li><strong>断言状态</strong>与预期相符。</li>
</ul>
<p>在执行操作之前没有必要等待任何东西：Playwright 在执行每个操作之前会自动等待一系列可操作性检查通过。</p>
<p>也没有必要在执行检查时处理竞态条件 - Playwright 断言的设计方式是它们描述了最终需要满足的预期。</p>
<p>就是这样！这些设计选择允许 Playwright 用户完全忘记他们测试中的不稳定超时和竞态检查。</p>
<p><strong>你将学到</strong></p>
<ul>
<li>如何编写第一个测试</li>
<li>如何执行操作</li>
<li>如何使用断言</li>
<li>测试如何独立运行</li>
<li>如何使用测试钩子</li>
</ul>
<h2 id="第一个测试">第一个测试<a hidden class="anchor" aria-hidden="true" href="#第一个测试">#</a></h2>
<p>查看以下示例，了解如何编写测试。注意文件名遵循 <code>test_</code> 前缀约定，以及每个测试名称。</p>
<p>test_example.py</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">playwright.sync_api</span> <span class="kn">import</span> <span class="n">Page</span><span class="p">,</span> <span class="n">expect</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_has_title</span><span class="p">(</span><span class="n">page</span><span class="p">:</span> <span class="n">Page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&#34;https://playwright.dev/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 期望标题“包含”一个子字符串。</span>
</span></span><span class="line"><span class="cl">    <span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">to_have_title</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&#34;Playwright&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_get_started_link</span><span class="p">(</span><span class="n">page</span><span class="p">:</span> <span class="n">Page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&#34;https://playwright.dev/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 点击“开始”链接。</span>
</span></span><span class="line"><span class="cl">    <span class="n">page</span><span class="o">.</span><span class="n">get_by_role</span><span class="p">(</span><span class="s2">&#34;link&#34;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Get started&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 期望页面有一个名为“安装”的标题。</span>
</span></span><span class="line"><span class="cl">    <span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">get_by_role</span><span class="p">(</span><span class="s2">&#34;heading&#34;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Installation&#34;</span><span class="p">))</span><span class="o">.</span><span class="n">to_be_visible</span><span class="p">()</span>
</span></span></code></pre></div><h2 id="操作">操作<a hidden class="anchor" aria-hidden="true" href="#操作">#</a></h2>
<h3 id="导航">导航<a hidden class="anchor" aria-hidden="true" href="#导航">#</a></h3>
<p>大多数测试将从导航到 URL 的页面开始。之后，测试将能够与页面元素进行交互。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&#34;https://playwright.dev/&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>Playwright 会等待页面达到加载状态，然后再继续。了解更多关于 page.goto() 选项的信息。</p>
<h3 id="交互">交互<a hidden class="anchor" aria-hidden="true" href="#交互">#</a></h3>
<p>执行操作从定位元素开始。Playwright 使用 Locators API 进行此操作。定位器代表了在任何时刻在页面上查找元素（或元素组）的方式，了解更多关于可用的不同类型定位器的信息。Playwright 会在执行操作之前等待元素可操作，因此没有必要等待其变为可用。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="c1"># 创建一个定位器。</span>
</span></span><span class="line"><span class="cl"><span class="n">get_started</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_by_role</span><span class="p">(</span><span class="s2">&#34;link&#34;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Get started&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 点击它。</span>
</span></span><span class="line"><span class="cl"><span class="n">get_started</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</span></span></code></pre></div><p>在大多数情况下，它会写成一行：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="n">page</span><span class="o">.</span><span class="n">get_by_role</span><span class="p">(</span><span class="s2">&#34;link&#34;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Get started&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</span></span></code></pre></div><h3 id="基本操作">基本操作<a hidden class="anchor" aria-hidden="true" href="#基本操作">#</a></h3>
<p>这是最受欢迎的 Playwright 操作列表。请注意，还有更多操作，请确保查看定位器 API 部分以了解更多信息。</p>
<table>
  <thead>
      <tr>
          <th>操作</th>
          <th>描述</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>locator.check()</td>
          <td>检查输入复选框</td>
      </tr>
      <tr>
          <td>locator.click()</td>
          <td>点击元素</td>
      </tr>
      <tr>
          <td>locator.uncheck()</td>
          <td>取消检查输入复选框</td>
      </tr>
      <tr>
          <td>locator.hover()</td>
          <td>鼠标悬停在元素上</td>
      </tr>
      <tr>
          <td>locator.fill()</td>
          <td>填写表单字段，输入文本</td>
      </tr>
      <tr>
          <td>locator.focus()</td>
          <td>使元素获得焦点</td>
      </tr>
      <tr>
          <td>locator.press()</td>
          <td>按下单个键</td>
      </tr>
      <tr>
          <td>locator.set_input_files()</td>
          <td>选择上传的文件</td>
      </tr>
      <tr>
          <td>locator.select_option()</td>
          <td>在下拉菜单中选择选项</td>
      </tr>
  </tbody>
</table>
<h2 id="断言">断言<a hidden class="anchor" aria-hidden="true" href="#断言">#</a></h2>
<p>Playwright 包括断言，这些断言会等待直到满足预期条件。使用这些断言可以使测试不脆弱且具有弹性。例如，这段代码会等待页面获得包含“Playwright”的标题：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">playwright.sync_api</span> <span class="kn">import</span> <span class="n">expect</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">to_have_title</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&#34;Playwright&#34;</span><span class="p">))</span>
</span></span></code></pre></div><p>这是最受欢迎的异步断言列表。请注意，还有更多断言需要熟悉：</p>
<table>
  <thead>
      <tr>
          <th>断言</th>
          <th>描述</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>expect(locator).to_be_checked()</td>
          <td>复选框被选中</td>
      </tr>
      <tr>
          <td>expect(locator).to_be_enabled()</td>
          <td>控件被启用</td>
      </tr>
      <tr>
          <td>expect(locator).to_be_visible()</td>
          <td>元素可见</td>
      </tr>
      <tr>
          <td>expect(locator).to_contain_text()</td>
          <td>元素包含文本</td>
      </tr>
      <tr>
          <td>expect(locator).to_have_attribute()</td>
          <td>元素具有属性</td>
      </tr>
      <tr>
          <td>expect(locator).to_have_count()</td>
          <td>元素列表具有给定长度</td>
      </tr>
      <tr>
          <td>expect(locator).to_have_text()</td>
          <td>元素匹配文本``</td>
      </tr>
      <tr>
          <td>expect(locator).to_have_value()</td>
          <td>输入元素具有值``</td>
      </tr>
      <tr>
          <td>expect(page).to_have_title()</td>
          <td>页面具有标题``</td>
      </tr>
      <tr>
          <td>expect(page).to_have_url()</td>
          <td>页面具有 URL</td>
      </tr>
  </tbody>
</table>
<h3 id="测试隔离">测试隔离<a hidden class="anchor" aria-hidden="true" href="#测试隔离">#</a></h3>
<p>Playwright Pytest 插件基于测试夹具的概念，例如内置的页面夹具，它被传递到你的测试中。由于浏览器上下文，页面在测试之间是隔离的，这相当于一个全新的浏览器配置文件，每个测试都获得一个新鲜环境，即使多个测试在单个浏览器中运行。</p>
<p>test_example.py</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">playwright.sync_api</span> <span class="kn">import</span> <span class="n">Page</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_example_test</span><span class="p">(</span><span class="n">page</span><span class="p">:</span> <span class="n">Page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="k">pass</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># “page”属于一个独立的 BrowserContext，为这个特定测试创建。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_another_test</span><span class="p">(</span><span class="n">page</span><span class="p">:</span> <span class="n">Page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="k">pass</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># 这个第二个测试中的“page”与第一个测试完全隔离。</span>
</span></span></code></pre></div><h3 id="使用夹具">使用夹具<a hidden class="anchor" aria-hidden="true" href="#使用夹具">#</a></h3>
<p>你可以使用各种夹具在测试之前或之后执行代码并共享对象。一个 <code>function</code> 作用域的夹具，例如带有 autouse 的，表现得像 beforeEach/afterEach。一个 <code>module</code> 作用域的夹具带有 autouse 表现得像 beforeAll/afterAll，它在所有测试之前和之后运行。</p>
<p>test_example.py</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pytest</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">playwright.sync_api</span> <span class="kn">import</span> <span class="n">Page</span><span class="p">,</span> <span class="n">expect</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@pytest.fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&#34;function&#34;</span><span class="p">,</span> <span class="n">autouse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">before_each_after_each</span><span class="p">(</span><span class="n">page</span><span class="p">:</span> <span class="n">Page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;before the test runs&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 在每个测试之前转到起始 URL。</span>
</span></span><span class="line"><span class="cl">    <span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&#34;https://playwright.dev/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">yield</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;after the test runs&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_main_navigation</span><span class="p">(</span><span class="n">page</span><span class="p">:</span> <span class="n">Page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 断言使用 expect API。</span>
</span></span><span class="line"><span class="cl">    <span class="n">expect</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">to_have_url</span><span class="p">(</span><span class="s2">&#34;https://playwright.dev/&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="接下来是什么-1">接下来是什么<a hidden class="anchor" aria-hidden="true" href="#接下来是什么-1">#</a></h2>
<ul>
<li>运行单个测试，多个测试，有头模式</li>
<li>使用 Codegen 生成测试</li>
<li>查看测试的跟踪</li>
<li>在 CI 上运行测试与 GitHub Actions</li>
</ul>
<h1 id="生成测试">生成测试<a hidden class="anchor" aria-hidden="true" href="#生成测试">#</a></h1>
<h2 id="引言-2">引言<a hidden class="anchor" aria-hidden="true" href="#引言-2">#</a></h2>
<p>Playwright 提供了开箱即用的测试生成能力，是快速开始测试的绝佳方式。它将打开两个窗口，一个浏览器窗口，您可以在其中与您想要测试的网站进行交互；另一个是 Playwright 检查器窗口，您可以在其中录制测试、复制测试、清除测试以及更改测试的语言。</p>
<p><strong>您将学到</strong></p>
<ul>
<li>如何录制测试</li>
<li>如何生成定位器</li>
</ul>
<h2 id="运行-codegen">运行 Codegen<a hidden class="anchor" aria-hidden="true" href="#运行-codegen">#</a></h2>
<p>使用 <code>codegen</code> 命令运行测试生成器，然后是您想要为其生成测试的网站的 URL。URL 是可选的，您也可以在不指定 URL 的情况下运行命令，然后在浏览器窗口中直接添加 URL。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Shell" data-lang="Shell"><span class="line"><span class="cl">playwright codegen demo.playwright.dev/todomvc
</span></span></code></pre></div><h3 id="录制测试">录制测试<a hidden class="anchor" aria-hidden="true" href="#录制测试">#</a></h3>
<p>运行 <code>codegen</code> 并在浏览器中执行操作。Playwright 将为用户交互生成代码。<code>Codegen</code> 将查看渲染后的页面并找出推荐的定位器，优先考虑角色、文本和测试 ID 定位器。如果生成器识别出多个元素与定位器匹配，它将改进定位器，使其更具弹性并唯一地识别目标元素，从而消除和减少由于定位器导致的测试失败和不稳定。</p>
<p>使用测试生成器，您可以录制：</p>
<ul>
<li>通过简单地与页面交互，执行点击或填充等操作</li>
<li>通过点击工具栏上的一个图标，然后点击页面上的元素进行断言。您可以选择：
<ul>
<li><code>'assert visibility'</code> 断言元素可见</li>
<li><code>'assert text'</code> 断言元素包含特定文本</li>
<li><code>'assert value'</code> 断言元素具有特定值</li>
</ul>
</li>
</ul>
<p><img loading="lazy" src="https://guangpuyun.feishu.cn/space/api/box/stream/download/asynccode/?code=MjgxNDZhNjkyZWZiYjk3MjkwOTAxMGIyMWUyOWU0NDNfVmZrcmkwWmt0blpHMHpNMm9JaTZCUXo5OFNWZnVUQXZfVG9rZW46Vm1IM2JadUFBb2Uza3V4SUdidGNYdnpYbm5mXzE3NDI0NjEyOTg6MTc0MjQ2NDg5OF9WNA"></p>
<p>当您完成与页面的交互后，按下 <code>'record'</code> 按钮停止录制，并使用 <code>'copy'</code> 按钮将生成的代码复制到您的编辑器中。</p>
<p>使用 <code>'clear'</code> 按钮清除代码以开始重新录制。完成后，关闭 Playwright 检查器窗口或停止终端命令。</p>
<p>要了解更多关于生成测试的信息，请查看我们关于 Codegen 的详细指南。</p>
<h3 id="生成定位器">生成定位器<a hidden class="anchor" aria-hidden="true" href="#生成定位器">#</a></h3>
<p>您可以使用测试生成器生成定位器。</p>
<ul>
<li>按下 <code>'Record'</code> 按钮停止录制，&lsquo;Pick Locator&rsquo;` 按钮将会出现。</li>
<li>点击 <code>'Pick Locator'</code> 按钮，然后将鼠标悬停在浏览器窗口的元素上，以查看定位器在每个元素下方突出显示。</li>
<li>要选择一个定位器，单击您想要定位的元素，该定位器的代码将出现在 Pick Locator 按钮旁边的定位器游乐场中。</li>
<li>然后您可以在定位器游乐场中编辑定位器以微调它，并看到匹配的元素在浏览器窗口中突出显示。</li>
<li>使用复制按钮复制定位器并将其粘贴到您的代码中。</li>
</ul>
<p><img loading="lazy" src="https://guangpuyun.feishu.cn/space/api/box/stream/download/asynccode/?code=YTRiNjEwY2U4MWUwY2EwZDc1YzliNDZmZGM5NWNiYzBfbVNUNjVQNE5vbjhkZWdBUG1VSkhYR2FlRU1QaXdiZUxfVG9rZW46UFB2eGJVeEhFb05wSmN4ZkM4QmNOam94bmxmXzE3NDI0NjEyOTg6MTc0MjQ2NDg5OF9WNA"></p>
<h3 id="仿真">仿真<a hidden class="anchor" aria-hidden="true" href="#仿真">#</a></h3>
<p>您还可以使用仿真生成测试，以便为特定的视口、设备、颜色方案生成测试，以及模拟地理位置、语言或时区。测试生成器还可以在保持认证状态的同时生成测试。查看测试生成器指南以了解更多信息。</p>
<h2 id="接下来做什么">接下来做什么<a hidden class="anchor" aria-hidden="true" href="#接下来做什么">#</a></h2>
<ul>
<li>查看您的测试跟踪</li>
</ul>
<h1 id="运行和调试">运行和调试<a hidden class="anchor" aria-hidden="true" href="#运行和调试">#</a></h1>
<h2 id="引言-3">引言<a hidden class="anchor" aria-hidden="true" href="#引言-3">#</a></h2>
<p>您可以运行单个测试、一组测试或所有测试。使用 <code>--browser</code> 标志，可以在一个浏览器或多个浏览器上运行测试。默认情况下，测试以无头模式运行，这意味着在运行测试时不会打开浏览器窗口，结果将在终端中显示。如果您愿意，可以通过使用 <code>--headed</code> CLI 参数以有头模式运行您的测试。</p>
<p><strong>您将学到</strong></p>
<ul>
<li>如何从命令行运行测试</li>
<li>如何调试测试</li>
</ul>
<h2 id="运行测试">运行测试<a hidden class="anchor" aria-hidden="true" href="#运行测试">#</a></h2>
<h3 id="命令行">命令行<a hidden class="anchor" aria-hidden="true" href="#命令行">#</a></h3>
<p>要运行您的测试，请使用 <code>pytest</code> 命令。这将默认在 Chromium 浏览器上运行您的测试。默认情况下，测试以无头模式运行，这意味着在运行测试时不会打开浏览器窗口，结果将在终端中显示。</p>
<h3 id="在有头模式下运行测试">在有头模式下运行测试<a hidden class="anchor" aria-hidden="true" href="#在有头模式下运行测试">#</a></h3>
<p>要以有头模式运行您的测试，请使用 <code>--headed</code> 标志。这将在运行测试时打开浏览器窗口，并在完成后关闭浏览器窗口。</p>
<h3 id="在不同的浏览器上运行测试">在不同的浏览器上运行测试<a hidden class="anchor" aria-hidden="true" href="#在不同的浏览器上运行测试">#</a></h3>
<p>要指定您想要运行测试的浏览器，请使用 <code>--browser</code> 标志，后跟浏览器的名称。</p>
<p>要指定要在多个浏览器上运行测试，请多次使用 <code>--browser</code> 标志，后跟每个浏览器的名称。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Shell" data-lang="Shell"><span class="line"><span class="cl">pytest --browser webkit --browser firefox
</span></span></code></pre></div><h3 id="运行特定测试">运行特定测试<a hidden class="anchor" aria-hidden="true" href="#运行特定测试">#</a></h3>
<p>要运行单个测试文件，请传入您想要运行的测试文件的名称。</p>
<p>要运行一组测试文件，请传入您想要运行的测试文件的名称。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Shell" data-lang="Shell"><span class="line"><span class="cl">pytest tests/test_todo_page.py tests/test_landing_page.py
</span></span></code></pre></div><p>要运行特定测试，请传入您想要运行的测试的函数名称。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Shell" data-lang="Shell"><span class="line"><span class="cl">pytest -k test_add_a_todo_item
</span></span></code></pre></div><h3 id="并行运行测试">并行运行测试<a hidden class="anchor" aria-hidden="true" href="#并行运行测试">#</a></h3>
<p>要并行运行您的测试，请使用 <code>--numprocesses</code> 标志，后跟您想要运行测试的进程数量。我们建议使用逻辑 CPU 核心数的一半。</p>
<p>（这假设已安装了 <code>pytest-xdist</code>。有关更多信息，请参见此处。）</p>
<p>有关更多信息，请参见 Playwright Pytest 使用情况或 Pytest 文档以了解一般 CLI 使用情况。</p>
<h2 id="调试测试">调试测试<a hidden class="anchor" aria-hidden="true" href="#调试测试">#</a></h2>
<p>由于 Playwright 在 Python 中运行，您可以使用您选择的调试器进行调试，例如使用 Visual Studio Code 中的 Python 扩展。Playwright 带有 Playwright 检查器，允许您逐步执行 Playwright API 调用，查看它们的调试日志并探索定位器。</p>
<p>要调试所有测试，请运行以下命令。</p>
<ul>
<li>Bash</li>
<li>PowerShell</li>
<li>Batch</li>
</ul>
<p>要调试一个测试文件，请在命令后运行您想要调试的测试文件的名称。</p>
<ul>
<li>Bash</li>
<li>PowerShell</li>
<li>Batch</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Shell" data-lang="Shell"><span class="line"><span class="cl"><span class="nv">PWDEBUG</span><span class="o">=</span><span class="m">1</span> pytest -s test_example.py
</span></span></code></pre></div><p>要调试特定测试，请添加 <code>-k</code> 后跟您想要调试的测试的名称。</p>
<ul>
<li>Bash</li>
<li>PowerShell</li>
<li>Batch</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Shell" data-lang="Shell"><span class="line"><span class="cl"><span class="nv">PWDEBUG</span><span class="o">=</span><span class="m">1</span> pytest -s -k test_get_started_link
</span></span></code></pre></div><p>此命令将打开浏览器窗口以及 Playwright 检查器。您可以使用检查器顶部的步过按钮逐步执行您的测试。或者按下播放按钮从开始到结束运行您的测试。一旦测试完成，浏览器窗口将关闭。</p>
<p>在调试时，您可以使用选择定位器按钮来选择页面上的元素，并查看 Playwright 用于查找该元素的定位器。您还可以编辑定位器并实时在浏览器窗口中看到它被高亮显示。使用复制定位器按钮将定位器复制到剪贴板，然后将其粘贴到您的测试中。</p>
<p><img loading="lazy" src="https://guangpuyun.feishu.cn/space/api/box/stream/download/asynccode/?code=ZGM3ZjNlYjFkMDBhYWZhODQ1YzFlZDg5ZWViMjZkZDlfSnZLTUlGc1FXZUk1NWdReUx2NzhjbkJtaHlSbzRvRFRfVG9rZW46VTRXM2JndjRib3lMZVZ4YXdlcGN1N2FGbkNiXzE3NDI0NjEyOTg6MTc0MjQ2NDg5OF9WNA"></p>
<p>查看我们的调试指南，以了解更多关于 Playwright 检查器以及使用浏览器开发工具进行调试的信息。</p>
<h2 id="接下来做什么-1">接下来做什么<a hidden class="anchor" aria-hidden="true" href="#接下来做什么-1">#</a></h2>
<ul>
<li>使用 Codegen 生成测试</li>
<li>查看您的测试跟踪</li>
<li>在 CI 上使用 GitHub Actions 运行您的测试</li>
</ul>
<h1 id="跟踪查看器">跟踪查看器<a hidden class="anchor" aria-hidden="true" href="#跟踪查看器">#</a></h1>
<h2 id="介绍">介绍<a hidden class="anchor" aria-hidden="true" href="#介绍">#</a></h2>
<p>Playwright Trace Viewer 是一个图形用户界面（GUI）工具，允许您探索录制的 Playwright 测试跟踪，这意味着您可以前后浏览测试的每个动作，并直观地看到每个动作期间发生了什么。</p>
<p><strong>您将学到</strong></p>
<ul>
<li>如何录制跟踪</li>
<li>如何打开 HTML 报告</li>
<li>如何打开跟踪查看器</li>
</ul>
<h2 id="录制跟踪">录制跟踪<a hidden class="anchor" aria-hidden="true" href="#录制跟踪">#</a></h2>
<p>可以通过使用 <code>--tracing</code> 标志运行测试来录制跟踪。</p>
<p>跟踪的选项有：</p>
<ul>
<li><code>on</code>: 为每个测试录制跟踪</li>
<li><code>off</code>: 不录制跟踪。（默认）</li>
<li><code>retain-on-failure</code>: 为每个测试录制跟踪，但删除成功测试运行的所有跟踪。</li>
</ul>
<p>这将录制跟踪并将其放入 <code>test-results</code> 目录中名为 <code>trace.zip</code> 的文件中。</p>
<p>如果您没有使用 Pytest，请点击这里了解如何录制跟踪。</p>
<ul>
<li>同步</li>
<li>异步</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="n">browser</span> <span class="o">=</span> <span class="n">chromium</span><span class="o">.</span><span class="n">launch</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">new_context</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 在创建/导航页面之前开始跟踪。</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">tracing</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">screenshots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">snapshots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">page</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&#34;https://playwright.dev&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 停止跟踪并将其导出到 zip 归档中。</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">tracing</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&#34;trace.zip&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="打开跟踪">打开跟踪<a hidden class="anchor" aria-hidden="true" href="#打开跟踪">#</a></h2>
<p>您可以使用 Playwright CLI 或在 <code>trace.playwright.dev</code> 上的浏览器中打开保存的跟踪。确保添加您的 <code>trace.zip</code> 文件所在的完整路径。这应该包括 <code>test-results</code> 目录，然后是测试名称，最后是 <code>trace.zip</code>。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">playwright show-trace trace.zip
</span></span></code></pre></div><h2 id="查看跟踪">查看跟踪<a hidden class="anchor" aria-hidden="true" href="#查看跟踪">#</a></h2>
<p>通过点击每个动作或使用时间线悬停来查看测试的跟踪，并查看动作前后页面的状态。在测试的每个步骤期间检查日志、源代码和网络。跟踪查看器创建了一个 DOM 快照，因此您可以完全与之交互，打开开发工具等。</p>
<p>要了解更多信息，请查看我们关于跟踪查看器的详细指南。</p>
<h2 id="接下来是什么-2">接下来是什么<a hidden class="anchor" aria-hidden="true" href="#接下来是什么-2">#</a></h2>
<ul>
<li>在 GitHub Actions 上运行 CI 测试</li>
<li>了解更多关于跟踪查看器的信息</li>
</ul>
<h1 id="pytest-插件来编写端到端测试">Pytest 插件来编写端到端测试<a hidden class="anchor" aria-hidden="true" href="#pytest-插件来编写端到端测试">#</a></h1>
<h2 id="引言-4">引言<a hidden class="anchor" aria-hidden="true" href="#引言-4">#</a></h2>
<p>Playwright 提供了一个 Pytest 插件来编写端到端测试。要开始使用它，请参考入门指南。</p>
<h2 id="使用方法">使用方法<a hidden class="anchor" aria-hidden="true" href="#使用方法">#</a></h2>
<p>要运行测试，请使用 Pytest 命令行界面。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">pytest --browser webkit --headed
</span></span></code></pre></div><p>如果你想自动添加命令行参数而不需要明确指定它们，你可以使用 pytest.ini 文件：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-TOML" data-lang="TOML"><span class="line"><span class="cl"><span class="c"># pytest.ini 文件的内容</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">pytest</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c"># 使用 UI 运行 firefox</span>
</span></span><span class="line"><span class="cl"><span class="nx">addopts</span> <span class="p">=</span> <span class="nx">--headed</span> <span class="nx">--browser</span> <span class="nx">firefox</span>
</span></span></code></pre></div><h2 id="命令行参数">命令行参数<a hidden class="anchor" aria-hidden="true" href="#命令行参数">#</a></h2>
<p>请注意，命令行参数仅应用于默认的 <code>browser</code>、<code>context</code> 和 <code>page</code> 固定装置。如果你使用 API 调用如 browser.new_context() 创建浏览器、上下文或页面，命令行参数将不会应用。</p>
<ul>
<li><code>--headed</code>：以有头模式运行测试（默认：无头）。</li>
<li><code>--browser</code>：在不同的浏览器中运行测试 <code>chromium</code>、<code>firefox</code> 或 <code>webkit</code>。可以多次指定（默认：<code>chromium</code>）。</li>
<li><code>--browser-channel</code>：要使用的浏览器渠道。</li>
<li><code>--slowmo</code>：通过指定的毫秒数减慢 Playwright 操作。这样你可以看清楚发生了什么（默认：0）。</li>
<li><code>--device</code>：要模拟的设备。</li>
<li><code>--output</code>：由测试产生的工件目录（默认：<code>test-results</code>）。</li>
<li><code>--tracing</code>：是否为每个测试记录跟踪。<code>on</code>、<code>off</code> 或 <code>retain-on-failure</code>（默认：<code>off</code>）。</li>
<li><code>--video</code>：是否为每个测试录制视频。<code>on</code>、<code>off</code> 或 <code>retain-on-failure</code>（默认：<code>off</code>）。</li>
<li><code>--screenshot</code>：是否在每个测试后自动捕获屏幕截图。<code>on</code>、<code>off</code> 或 <code>only-on-failure</code>（默认：<code>off</code>）。</li>
<li><code>--full-page-screenshot</code>：在失败时是否拍摄整个页面的屏幕截图。默认情况下，只捕获视口。需要启用 <code>--screenshot</code>（默认：<code>off</code>）。</li>
</ul>
<h2 id="固定装置">固定装置<a hidden class="anchor" aria-hidden="true" href="#固定装置">#</a></h2>
<p>这个插件为 pytest 配置了 Playwright 特定的固定装置。要使用这些固定装置，将固定装置名称作为参数传递给测试函数。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_my_app_is_working</span><span class="p">(</span><span class="n">fixture_name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">pass</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 使用 fixture_name 进行测试</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ...</span>
</span></span></code></pre></div><p><strong>函数范围</strong> ：当在测试函数中请求时，这些固定装置被创建，并在测试结束时销毁。</p>
<ul>
<li><code>context</code>：测试的新浏览器上下文。</li>
<li><code>page</code>：测试的新浏览器页面。</li>
<li><code>new_context</code>：允许为测试创建不同的浏览器上下文。适用于多用户场景。接受与 browser.new_context() 相同的参数。</li>
</ul>
<p><strong>会话范围</strong> ：当在测试函数中请求时，这些固定装置被创建，并在所有测试结束时销毁。</p>
<ul>
<li><code>playwright</code>：Playwright 实例。</li>
<li><code>browser_type</code>：当前浏览器的 BrowserType 实例。</li>
<li><code>browser</code>：由 Playwright 启动的浏览器实例。</li>
<li><code>browser_name</code>：浏览器名称字符串。</li>
<li><code>browser_channel</code>：浏览器渠道字符串。</li>
<li><code>is_chromium</code>、<code>is_webkit</code>、<code>is_firefox</code>：相应浏览器类型的布尔值。</li>
</ul>
<p><strong>自定义固定装置选项</strong> ：对于 <code>browser</code> 和 <code>context</code> 固定装置，使用以下固定装置定义自定义启动选项。</p>
<ul>
<li><code>browser_type_launch_args</code>：覆盖 browser_type.launch() 的启动参数。它应该返回一个字典。</li>
<li><code>browser_context_args</code>：覆盖 browser.new_context() 的选项。它应该返回一个字典。</li>
</ul>
<p>也可以通过使用 <code>browser_context_args</code> 标记来覆盖单个测试的上下文选项（browser.new_context()）：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pytest</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@pytest.mark.browser_context_args</span><span class="p">(</span><span class="n">timezone_id</span><span class="o">=</span><span class="s2">&#34;Europe/Berlin&#34;</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="s2">&#34;en-GB&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_browser_context_args</span><span class="p">(</span><span class="n">page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">page</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s2">&#34;window.navigator.userAgent&#34;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&#34;Europe/Berlin&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">page</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s2">&#34;window.navigator.languages&#34;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&#34;de-DE&#34;</span><span class="p">]</span>
</span></span></code></pre></div><h2 id="并行性同时运行多个测试">并行性：同时运行多个测试<a hidden class="anchor" aria-hidden="true" href="#并行性同时运行多个测试">#</a></h2>
<p>如果你的测试在拥有大量 CPU 的机器上运行，你可以通过使用 <code>pytest-xdist</code> 同时运行多个测试来加快测试套件的整体执行时间：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl"><span class="c1"># 安装依赖</span>
</span></span><span class="line"><span class="cl">pip install pytest-xdist
</span></span><span class="line"><span class="cl"><span class="c1"># 使用 --numprocesses 标志</span>
</span></span><span class="line"><span class="cl">pytest --numprocesses auto
</span></span></code></pre></div><p>根据硬件和测试的性质，你可以将 <code>numprocesses</code> 设置为从 <code>2</code> 到机器上的 CPU 数量。如果设置得太高，你可能会注意到意外的行为。</p>
<p>有关 <code>pytest</code> 选项的一般信息，请参见运行测试。</p>
<h2 id="示例">示例<a hidden class="anchor" aria-hidden="true" href="#示例">#</a></h2>
<h3 id="为自动补全配置-mypy-类型">为自动补全配置 Mypy 类型<a hidden class="anchor" aria-hidden="true" href="#为自动补全配置-mypy-类型">#</a></h3>
<p>test_my_application.py</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">playwright.sync_api</span> <span class="kn">import</span> <span class="n">Page</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_visit_admin_dashboard</span><span class="p">(</span><span class="n">page</span><span class="p">:</span> <span class="n">Page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&#34;/admin&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ...</span>
</span></span></code></pre></div><h3 id="配置慢动作">配置慢动作<a hidden class="anchor" aria-hidden="true" href="#配置慢动作">#</a></h3>
<p>使用 <code>--slowmo</code> 参数运行测试。</p>
<p>将 Playwright 操作减慢 100 毫秒。</p>
<h3 id="按浏览器跳过测试">按浏览器跳过测试<a hidden class="anchor" aria-hidden="true" href="#按浏览器跳过测试">#</a></h3>
<p>test_my_application.py</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pytest</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@pytest.mark.skip_browser</span><span class="p">(</span><span class="s2">&#34;firefox&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_visit_example</span><span class="p">(</span><span class="n">page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&#34;https://example.com&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ...</span>
</span></span></code></pre></div><h3 id="在特定浏览器上运行">在特定浏览器上运行<a hidden class="anchor" aria-hidden="true" href="#在特定浏览器上运行">#</a></h3>
<p>conftest.py</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pytest</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@pytest.mark.only_browser</span><span class="p">(</span><span class="s2">&#34;chromium&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_visit_example</span><span class="p">(</span><span class="n">page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&#34;https://example.com&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ...</span>
</span></span></code></pre></div><h3 id="使用自定义浏览器渠道如-google-chrome-或-microsoft-edge">使用自定义浏览器渠道，如 Google Chrome 或 Microsoft Edge<a hidden class="anchor" aria-hidden="true" href="#使用自定义浏览器渠道如-google-chrome-或-microsoft-edge">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">pytest --browser-channel chrome
</span></span></code></pre></div><p>test_my_application.py</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_example</span><span class="p">(</span><span class="n">page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&#34;https://example.com&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="配置基础-url">配置基础 URL<a hidden class="anchor" aria-hidden="true" href="#配置基础-url">#</a></h3>
<p>使用 <code>base-url</code> 参数启动 Pytest。<code>pytest-base-url</code> 插件用于此目的，它允许你从配置、命令行参数或固定装置中设置基础 URL。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="line"><span class="cl">pytest --base-url http://localhost:8080
</span></span></code></pre></div><p>test_my_application.py</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_visit_example</span><span class="p">(</span><span class="n">page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&#34;/admin&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># -&gt; 将导致 http://localhost:8080/admin</span>
</span></span></code></pre></div><h3 id="忽略-https-错误">忽略 HTTPS 错误<a hidden class="anchor" aria-hidden="true" href="#忽略-https-错误">#</a></h3>
<p>conftest.py</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pytest</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@pytest.fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&#34;session&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">browser_context_args</span><span class="p">(</span><span class="n">browser_context_args</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">**</span><span class="n">browser_context_args</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ignore_https_errors&#34;</span><span class="p">:</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><h3 id="使用自定义视口大小">使用自定义视口大小<a hidden class="anchor" aria-hidden="true" href="#使用自定义视口大小">#</a></h3>
<p>conftest.py</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pytest</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@pytest.fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&#34;session&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">browser_context_args</span><span class="p">(</span><span class="n">browser_context_args</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">**</span><span class="n">browser_context_args</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;viewport&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;width&#34;</span><span class="p">:</span> <span class="mi">1920</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;height&#34;</span><span class="p">:</span> <span class="mi">1080</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><h3 id="设备模拟">设备模拟<a hidden class="anchor" aria-hidden="true" href="#设备模拟">#</a></h3>
<p>conftest.py</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pytest</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@pytest.fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&#34;session&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">browser_context_args</span><span class="p">(</span><span class="n">browser_context_args</span><span class="p">,</span> <span class="n">playwright</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">iphone_11</span> <span class="o">=</span> <span class="n">playwright</span><span class="o">.</span><span class="n">devices</span><span class="p">[</span><span class="s1">&#39;iPhone 11 Pro&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">**</span><span class="n">browser_context_args</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="o">**</span><span class="n">iphone_11</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p>或通过命令行 <code>--device=&quot;iPhone 11 Pro&quot;</code>。</p>
<h3 id="与-unittesttestcase-一起使用">与 <code>unittest.TestCase</code> 一起使用<a hidden class="anchor" aria-hidden="true" href="#与-unittesttestcase-一起使用">#</a></h3>
<p>查看以下示例，了解如何将其与 <code>unittest.TestCase</code> 一起使用。这有一个限制，即只能指定单个浏览器，并且在指定多个浏览器时不会生成多个浏览器的矩阵。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pytest</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">unittest</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">playwright.sync_api</span> <span class="kn">import</span> <span class="n">Page</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MyTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@pytest.fixture</span><span class="p">(</span><span class="n">autouse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="n">Page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">=</span> <span class="n">page</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_foobar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&#34;https://microsoft.com&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">locator</span><span class="p">(</span><span class="s2">&#34;#foobar&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s2">&#34;1 + 1&#34;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</span></span></code></pre></div><h2 id="调试">调试<a hidden class="anchor" aria-hidden="true" href="#调试">#</a></h2>
<h3 id="与-pdb-一起使用">与 pdb 一起使用<a hidden class="anchor" aria-hidden="true" href="#与-pdb-一起使用">#</a></h3>
<p>在你的测试代码中使用 <code>breakpoint()</code> 语句来暂停执行并获得 pdb REPL。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_bing_is_working</span><span class="p">(</span><span class="n">page</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s2">&#34;https://bing.com&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">breakpoint</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ...</span>
</span></span></code></pre></div><h2 id="部署到-ci">部署到 CI<a hidden class="anchor" aria-hidden="true" href="#部署到-ci">#</a></h2>
<p>请参阅 CI 提供商的指南，了解如何将你的测试部署到 CI/CD。</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/post/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/mysql----%E5%A4%8D%E5%90%88%E6%9F%A5%E8%AF%A2/">
    <span class="title">« </span>
    <br>
    <span>MySQL -- 复合查询</span>
  </a>
  <a class="next" href="http://localhost:1313/post/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/pytest-intro/">
    <span class="title"> »</span>
    <br>
    <span>pytest-intro</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share playwright的python文档 on x"
            href="https://x.com/intent/tweet/?text=playwright%e7%9a%84python%e6%96%87%e6%a1%a3&amp;url=http%3a%2f%2flocalhost%3a1313%2fpost%2f%25E8%2587%25AA%25E5%258A%25A8%25E5%258C%2596%25E6%25B5%258B%25E8%25AF%2595%2fplaywright%25E7%259A%2584python%25E6%2596%2587%25E6%25A1%25A3%2f&amp;hashtags=">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share playwright的python文档 on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fpost%2f%25E8%2587%25AA%25E5%258A%25A8%25E5%258C%2596%25E6%25B5%258B%25E8%25AF%2595%2fplaywright%25E7%259A%2584python%25E6%2596%2587%25E6%25A1%25A3%2f&amp;title=playwright%e7%9a%84python%e6%96%87%e6%a1%a3&amp;summary=playwright%e7%9a%84python%e6%96%87%e6%a1%a3&amp;source=http%3a%2f%2flocalhost%3a1313%2fpost%2f%25E8%2587%25AA%25E5%258A%25A8%25E5%258C%2596%25E6%25B5%258B%25E8%25AF%2595%2fplaywright%25E7%259A%2584python%25E6%2596%2587%25E6%25A1%25A3%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share playwright的python文档 on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fpost%2f%25E8%2587%25AA%25E5%258A%25A8%25E5%258C%2596%25E6%25B5%258B%25E8%25AF%2595%2fplaywright%25E7%259A%2584python%25E6%2596%2587%25E6%25A1%25A3%2f&title=playwright%e7%9a%84python%e6%96%87%e6%a1%a3">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share playwright的python文档 on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fpost%2f%25E8%2587%25AA%25E5%258A%25A8%25E5%258C%2596%25E6%25B5%258B%25E8%25AF%2595%2fplaywright%25E7%259A%2584python%25E6%2596%2587%25E6%25A1%25A3%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share playwright的python文档 on whatsapp"
            href="https://api.whatsapp.com/send?text=playwright%e7%9a%84python%e6%96%87%e6%a1%a3%20-%20http%3a%2f%2flocalhost%3a1313%2fpost%2f%25E8%2587%25AA%25E5%258A%25A8%25E5%258C%2596%25E6%25B5%258B%25E8%25AF%2595%2fplaywright%25E7%259A%2584python%25E6%2596%2587%25E6%25A1%25A3%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share playwright的python文档 on telegram"
            href="https://telegram.me/share/url?text=playwright%e7%9a%84python%e6%96%87%e6%a1%a3&amp;url=http%3a%2f%2flocalhost%3a1313%2fpost%2f%25E8%2587%25AA%25E5%258A%25A8%25E5%258C%2596%25E6%25B5%258B%25E8%25AF%2595%2fplaywright%25E7%259A%2584python%25E6%2596%2587%25E6%25A1%25A3%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share playwright的python文档 on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=playwright%e7%9a%84python%e6%96%87%e6%a1%a3&u=http%3a%2f%2flocalhost%3a1313%2fpost%2f%25E8%2587%25AA%25E5%258A%25A8%25E5%258C%2596%25E6%25B5%258B%25E8%25AF%2595%2fplaywright%25E7%259A%2584python%25E6%2596%2587%25E6%25A1%25A3%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">蓝色空间号</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
